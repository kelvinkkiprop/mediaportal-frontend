import{a as O}from"./chunk-TCXR53AK.js";import{a as W,b as $,c as G}from"./chunk-B75XZRDH.js";import{a as K}from"./chunk-47TLDLVH.js";import{e as R,h as H,i as j}from"./chunk-QFRYTLOK.js";import{h as k,j as V}from"./chunk-KZGKNQKD.js";import{b as U,h as q}from"./chunk-LPEF23WO.js";import{A as f,Ab as D,Db as d,H as S,Ha as P,I as y,Ia as l,Ja as w,Ka as T,Ra as E,Sa as F,Y as a,Za as L,aa as I,ca as _,da as u,ga as c,ib as N,jb as B,ka as m,mb as h,pa as n,qa as s,ra as g,ua as b,wa as M,xa as C}from"./chunk-FCMXJ2TO.js";import{f as J}from"./chunk-GAL4ENT6.js";var z=J(K());var Q=()=>["/media/watch"],X=t=>({entity:t});function Z(t,i){t&1&&g(0,"app-progress")}function ee(t,i){if(t&1&&(n(0,"div",16)(1,"a",17),g(2,"app-media-card",18),n(3,"h6",6),l(4),s(),n(5,"div",19),l(6),s()()()),t&2){let e=i.$implicit;a(),m("routerLink",E(5,Q))("queryParams",F(6,X,e.id)),a(),m("data",e),a(2),w(e.name),a(2),T("",e.total_media," media")}}function te(t,i){if(t&1&&(n(0,"div",14),c(1,ee,7,8,"div",15),s()),t&2){let e=C();a(),m("ngForOf",e.mItems)}}function ie(t,i){t&1&&g(0,"app-loader")}function re(t,i){t&1&&(n(0,"p",20),l(1,"No items"),s())}var v=class t{constructor(i,e){this.mUserService=i;this.mToastrService=e}mItems=[];itemForm;search_term;mProgress=!1;links=[];currentPage=1;mLoadingMore=!1;mHasMorePages=!0;ngOnInit(){this.index(this.currentPage),this.search_term=new j("",R.required),this.itemForm=new H({search_term:this.search_term})}index(i){this.currentPage===1&&(this.mProgress=!0);let e=typeof i=="string"?i:`?page=${this.currentPage}`;this.mUserService.entityItems(e).subscribe({next:r=>{this.currentPage===1?this.mItems=r.data:this.mItems=[...this.mItems,...r.data],this.mProgress=!1,this.links=r.links,this.mLoadingMore=!1;let o=this.links.find(p=>p.label==="Next &raquo;");this.mHasMorePages=!!o?.url},error:()=>{this.mLoadingMore=!1,this.mHasMorePages=!1}})}onLoadMore(){if(!this.mHasMorePages||this.mLoadingMore)return;let i=this.links.find(e=>e.label==="Next &raquo;");i?(this.mLoadingMore=!0,this.currentPage++,this.index(i)):this.mHasMorePages=!1}onDelete(i){z.default.mixin({customClass:{cancelButton:"btn btn-dark me-2",confirmButton:"btn btn-danger"},buttonsStyling:!1}).fire({title:"Remove?",text:"You won't be able to revert this!",icon:"error",showCancelButton:!0,reverseButtons:!0,cancelButtonText:"Cancel",confirmButtonText:"Delete"}).then(r=>{r.isConfirmed&&(this.mProgress=!0,this.mUserService.deleteItem(i).subscribe({next:o=>{o&&(this.mItems=this.mItems.filter(p=>p.id!==i.id),this.mToastrService.error(o.message),this.mProgress=!1)},error:o=>{o.error.message&&this.mToastrService.error(o.error.message),this.mProgress=!1}}))})}onSearch(i){this.mProgress=!0,this.mUserService.searchItems(i).subscribe({next:e=>{e&&(this.mItems=e.data,this.mToastrService.success(e.message),this.mProgress=!1)},error:e=>{e.error.message&&this.mToastrService.error(e.error.message),this.mProgress=!1}})}static \u0275fac=function(e){return new(e||t)(I(O),I(k))};static \u0275cmp=_({type:t,selectors:[["app-index"]],standalone:!1,decls:23,vars:7,consts:[["noItemsTemplate",""],[4,"ngIf"],[1,"app-content-header"],[1,"container-fluid"],[1,"row"],[1,"col-sm-6"],[1,"mb-0"],[1,"breadcrumb","float-sm-end"],[1,"breadcrumb-item"],["href","#"],["aria-current","page",1,"breadcrumb-item","active"],[1,"app-content"],["infiniteScroll","",1,"card-body",3,"scrolled","infiniteScrollDistance","infiniteScrollThrottle","infiniteScrollDisabled"],["class","row row-cols-1 row-cols-sm-2 row-cols-md-4 g-4",4,"ngIf","ngIfElse"],[1,"row","row-cols-1","row-cols-sm-2","row-cols-md-4","g-4"],["class","col",4,"ngFor","ngForOf"],[1,"col"],[1,"row","text-decoration-none","text-reset",3,"routerLink","queryParams"],[3,"data"],[1,"pt-0","text-muted"],[1,"p-5","text-center","text-muted"]],template:function(e,r){if(e&1){let o=b();c(0,Z,1,0,"app-progress",1),n(1,"section")(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h3",6),l(7,"Entities"),s()(),n(8,"div",5)(9,"ol",7)(10,"li",8)(11,"a",9),l(12,"Home"),s()(),n(13,"li",10),l(14,"Entities"),s()()()()()(),n(15,"div",11)(16,"div",3)(17,"div",12),M("scrolled",function(){return S(o),y(r.onLoadMore())}),c(18,te,2,1,"div",13),n(19,"div"),c(20,ie,1,0,"app-loader",1),s(),c(21,re,2,0,"ng-template",null,0,L),s()()()()}if(e&2){let o=P(22);m("ngIf",r.mProgress),a(17),m("infiniteScrollDistance",2)("infiniteScrollThrottle",150)("infiniteScrollDisabled",!r.mHasMorePages||r.mLoadingMore),a(),m("ngIf",r.mItems&&r.mItems.length>0)("ngIfElse",o),a(2),m("ngIf",r.mLoadingMore)}},dependencies:[N,B,D,V,W,U,$],encapsulation:2})};var oe=[{path:"",redirectTo:"index",pathMatch:"full"},{path:"index",component:v,data:{title:"Index"}}],x=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=u({type:t});static \u0275inj=f({imports:[h,d.forChild(oe),d]})};var A=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=u({type:t});static \u0275inj=f({imports:[h,d,x,q,G]})};export{A as EntityModule};
